<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="generator" content="Jekyll v3.3.0">

		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700">
		<link rel="stylesheet" href="/css/main.css">

		<title>Dependency Injection</title>

		<link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
		<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
		<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
		<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
		<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
		<link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
		<link rel="manifest" href="/manifest.json">
		<meta name="msapplication-TileColor" content="#ffffff">
		<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
		<meta name="theme-color" content="#ffffff">
	</head>

	<body>
		<header>
			<h1>
				<img src="/images/logo.svg" alt="React4j" width="45">
				React4J User Manual
				<button type="button" class="open-nav" id="open-nav"></button>
			</h1>

			<form action="/search/" method="get">
				<input type="text" name="q" id="search-input" placeholder="Search" autofocus>
				<input type="submit" value="Search" style="display: none;">
			</form>

			<nav >
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/">Introduction</a>
					</li>
				</ul>

				<ul>
					
					
						<li class="nav-item top-level current">
							
							<a href="/faq/">General</a>
							<ul>
								
									<li class="nav-item "><a href="/faq/">Frequently Asked Questions</a></li>
								
									<li class="nav-item "><a href="/compared_to_react/">Compared to React</a></li>
								
									<li class="nav-item "><a href="/arez/">Arez</a></li>
								
									<li class="nav-item current"><a href="/dependency_injection/">Dependency Injection</a></li>
								
							</ul>
						</li>
					
				</ul>
				<ul>
					<li class="nav-item top-level">
						
						<a href="/api/index.html" target="_blank">Javadocs</a>
					</li>
				</ul>
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/changelog/">Change Log</a>
					</li>
				</ul>
			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>General</h2>
				<h3>Dependency Injection</h3>
			</div>
			<article class="content">
				<p>React4j can be integrated with dependency injection frameworks such as <a href="https://google.github.io/dagger">Dagger2</a>
and <a href="https://code.google.com/archive/p/google-gin/">GIN</a>. The dependency injection framework is responsible
for creating the component and injecting the required dependencies.</p>

<p>The author declares the dependencies of a React4j component by annotating fields or setter methods with
the <code class="highlighter-rouge">@Inject</code> annotation. The annotation processor then detects these dependencies and generates the required
infrastructure for injecting dependencies into the react4j component. The author can explicitly control the
injection infrastructure generated by setting the <code class="highlighter-rouge">inject</code> parameter on the <code class="highlighter-rouge">@ReactComponent</code> annotation.</p>

<p>The <code class="highlighter-rouge">@ReactComponent</code> annotation on the component can explicitly enable injection (by setting the value
of the <code class="highlighter-rouge">inject</code> parameter to <code class="highlighter-rouge">TRUE</code>), explicitly disable injection (by setting the value of the <code class="highlighter-rouge">inject</code>
parameter to <code class="highlighter-rouge">FALSE</code>) or leave value as <code class="highlighter-rouge">IF_DETECTED</code> to automatically determine whether the injection
infrastructure is required.</p>

<p>Enabling injection for a component will mean that the component will be constructed by an instance of
<code class="highlighter-rouge">javax.inject.Provider</code> that is expected to be provided by the injection framework. The enhanced component
subclass will have a static field for the <code class="highlighter-rouge">javax.inject.Provider</code> instance that must be configured prior to
instantiating the component. Enabling injection will also result in the addition of an <code class="highlighter-rouge">@javax.inject.Inject</code>
annotation being added to the constructor of the enhanced component subclass.</p>

<p>Components that extend <code class="highlighter-rouge">ReactArezComponent</code> have slightly different mechanisms for implementing this
functionality and tie into the [dependency injection])(https://arez.github.io/components/dependency_injection)
infrastructure provided by Arez. However there should be no practical differences from the perspective of a
React4j user.</p>

<h2 id="dagger2">Dagger2</h2>

<p><a href="https://google.github.io/dagger">Dagger2</a> is a modern take on a dependency injection framework that uses annotation
processors and statically checks the object graph at compilation time. The root objects in the graph are accessed via
a component which is an interface annotated by the <code class="highlighter-rouge">@dagger.Component</code> annotation. The injection rules are customized
via <code class="highlighter-rouge">@dagger.Module</code> annotated classes.</p>

<p>React4j has greater support for the dagger injection framework than GIN. The <a href="/api/react4j/annotations/ReactComponent.html">@ReactComponent</a>
annotation has a <code class="highlighter-rouge">dagger</code> parameter that controls whether the React4j annotation processor generates a dagger
subcomponent and supporting module. As with the <code class="highlighter-rouge">inject</code> parameter it can be explicitly enabled, disabled or
the default value <code class="highlighter-rouge">IF_DETECTED</code>. The <code class="highlighter-rouge">IF_DETECTED</code> value determines whether the component requires injection and
whether dagger is present on the classpath and enables dagger if these conditions are true.</p>

<p>If dagger is enabled then the react4j annotation processor generates an additional class named
<code class="highlighter-rouge">[ComponentName]DaggerFactory</code> that aims to simplify integration into dagger based infrastructure.
The infrastructure looks like:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MyComponentDaggerFactory</span>
<span class="o">{</span>
  <span class="n">DaggerSubcomponent</span> <span class="nf">getMyComponentDaggerSubcomponent</span><span class="o">();</span>

  <span class="k">default</span> <span class="kt">void</span> <span class="nf">bindMyComponent</span><span class="o">()</span>
  <span class="o">{</span>
    <span class="n">MyComponent_</span><span class="o">.</span><span class="na">setProvider</span><span class="o">(</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">getMyComponentDaggerSubcomponent</span><span class="o">().</span><span class="na">get</span><span class="o">()</span> <span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Module</span>
  <span class="kd">final</span> <span class="kd">class</span> <span class="nc">DaggerModule</span>
  <span class="o">{</span>
    <span class="nd">@Provides</span>
    <span class="kd">static</span> <span class="n">Component</span> <span class="nf">provideComponent</span><span class="o">(</span> <span class="kd">final</span> <span class="n">MyComponent_</span> <span class="n">component</span> <span class="o">)</span>
    <span class="o">{</span>
      <span class="k">return</span> <span class="n">component</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="nd">@Subcomponent</span><span class="o">(</span> <span class="n">modules</span> <span class="o">=</span> <span class="n">DaggerModule</span><span class="o">.</span><span class="na">class</span> <span class="o">)</span>
  <span class="kd">interface</span> <span class="nc">DaggerSubcomponent</span>
  <span class="o">{</span>
    <span class="n">Provider</span><span class="o">&lt;</span><span class="n">Component</span><span class="o">&gt;</span> <span class="nf">createProvider</span><span class="o">();</span>

    <span class="k">default</span> <span class="n">MyComponent</span> <span class="nf">get</span><span class="o">()</span>
    <span class="o">{</span>
      <span class="k">return</span> <span class="o">(</span><span class="n">MyComponent</span><span class="o">)</span> <span class="n">createProvider</span><span class="o">().</span><span class="na">get</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>Integration into a dagger component is as simple as extending the <code class="highlighter-rouge">[ComponentName]DaggerFactory</code>. This results
in a dagger component like:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Singleton</span>
<span class="nd">@Component</span><span class="o">(</span> <span class="n">modules</span> <span class="o">=</span> <span class="o">{</span> <span class="n">SomeDaggerModule</span><span class="o">.</span><span class="na">class</span> <span class="o">}</span> <span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ExampleDaggerComponent</span>
  <span class="kd">extends</span> <span class="n">MyComponentDaggerFactory</span>
<span class="o">{</span>
<span class="o">}</span></code></pre></figure>

<p>The following code example shows how to instantiate the Dagger component and bind the <code class="highlighter-rouge">Provider</code>
instance to the enhanced component class. Unfortunately it is currently required that the developer
invokes the <code class="highlighter-rouge">bind[ComponentName]()</code> method for every component is injection enabled. In the future this
may not be required but it is at this stage.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">final</span> <span class="n">ExampleDaggerComponent</span> <span class="n">component</span> <span class="o">=</span> <span class="n">DaggerExampleDaggerComponent</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
<span class="n">component</span><span class="o">.</span><span class="na">bindMyComponent</span><span class="o">();</span></code></pre></figure>


			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});
		</script>
	</body>
</html>
